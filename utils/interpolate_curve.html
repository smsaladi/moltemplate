
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>21. interpolate_curve.py &#8212; moltemplate 2.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="22. ltemplify.py" href="ltemplify.html" />
    <link rel="prev" title="20. genpoly_lt.py" href="genpoly_lt.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="interpolate-curve-py">
<h1><span class="section-number">21. </span>interpolate_curve.py<a class="headerlink" href="#interpolate-curve-py" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2><span class="section-number">21.1. </span>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>“interpolate_curve.py” is a crude program which uses (Catmull-Rom) cubic
spline interpolation to generate a set of evenly spaced coordinates
which lie along smooth a curve specified by the user.</p>
<p>Note: This program is both a stand-alone executable program (that can be
run from the terminal) and a python library. The former is documented
below. <em>(The</em><a class="reference external" href="#Python-API">python API is explained later</a><em>.)</em></p>
</div>
<div class="section" id="usage-from-the-terminal">
<h2><span class="section-number">21.2. </span>Usage (from the terminal)<a class="headerlink" href="#usage-from-the-terminal" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interpolate_curve</span><span class="o">.</span><span class="n">py</span> <span class="n">Ndesired</span> <span class="p">[</span><span class="n">scale</span><span class="p">]</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">old_coords</span><span class="o">.</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">new_coords</span><span class="o">.</span><span class="n">raw</span>
</pre></div>
</div>
<p>The old_coords.raw and new_coords.raw are 3-column text files containing
x,y,z coordinates. The new_coords.raw file in this example will contain
<strong>Ndesired</strong> coordinates distributed along the path whose control points
are stored in the file “old_coords.raw”. The optional <strong>scale</strong>
parameter will cause the resulting coordinates to be multiplied by a
constant (default 1).</p>
<p>(The optional <strong>alpha</strong> parameter is a number between <em>0.0</em> and <em>1.0</em>
whose value effects the smoothness of the interpolation. The default
value, <em>0.5</em>, corresponds to a <a class="reference external" href="https://en.wikipedia.org/wiki/Centripetal_Catmull%E2%80%93Rom_spline">centripital Catmull-Rom
spline</a>.)</p>
<div class="section" id="using-moltemplate-to-trace-a-polymer-along-a-path">
<h3><span class="section-number">21.2.1. </span>Using Moltemplate to trace a polymer along a path<a class="headerlink" href="#using-moltemplate-to-trace-a-polymer-along-a-path" title="Permalink to this headline">¶</a></h3>
<p>This tool can be useful to help prepare polymer simulations with
moltemplate. There are a variety of algorithms that generate random
(space-filling) curves, and these curves can be used as inputs to the
<a class="reference external" href="doc_genpoly_lt.md">genpoly_lt.py</a> program which generates polymer
molecules in moltemplate (.LT) format. The <em>genpoly_lt.py</em> program
requires a file containing the x,y,z coordinates where you want each
monomer to go. An example of its usage can be found
<a class="reference external" href="http://moltemplate.org/images/misc/polymers_follow_a_curve.png">here.</a></p>
<p>Unfortunately, most randomly generated curves contain sharp corners, and
the spacing between the control points rarely matches the distance
between monomers in a polymer. The <em>interpolate_curve.py</em> script
addresses this issue, allowing you to resample a curve with the desired
scale and resolution.</p>
</div>
<div class="section" id="example">
<h3><span class="section-number">21.2.2. </span>Example:<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Here we use <a class="reference external" href="https://github.com/jewettaij/ndmansfield">ndmansfield</a>
to generate an initial (space-filling) curve for the shape of the
polymer. Then we use <em>interpolate_curve.py</em> to smooth and rescale this
curve before using
[<em>genpoly_lt.py</em>]https://github.com/jewettaij/moltemplate/blob/master/doc/doc_genpoly_lt.md)
to build a polymer which can be simulated with the help of
<a class="reference external" href="https://github.com/jewettaij/moltemplate">moltemplate.sh</a> and
<a class="reference external" href="http://lammps.sandia.gov">LAMMPS</a>.</p>
<p>First step: Create a small jagged version of the curve using
<em>ndmansfield</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ndmansfield</span> <span class="o">-</span><span class="n">box</span> <span class="mi">53</span> <span class="mi">40</span> <span class="mi">31</span> <span class="o">-</span><span class="n">cyclic</span> <span class="n">yes</span> <span class="o">-</span><span class="n">seed</span> <span class="mi">1</span>  \
            <span class="o">-</span><span class="n">tsave</span> <span class="mi">200000</span> <span class="o">-</span><span class="n">tstop</span> <span class="mi">3200000</span>       \
            <span class="o">&gt;</span> <span class="n">ndmansfield_traj_53x40x31</span><span class="o">.</span><span class="n">raw</span>
</pre></div>
</div>
<p>In this example, this program generates a random space-filling curve (a
“Hamiltonian path”) which fills a rectangular lattice of size 53 x 40 x
31. <em>(This program uses Monte-Carlo to generate a series of increasingly
random polymer shapes as the simulation progresses.)</em> The coordinates of
the polymer will be written to a file (“ndmansfield_traj_53x40x31.raw”).
This is a 3-column text file (with blank-line delimeters). It has the
following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="n">y1</span> <span class="n">z1</span>     <span class="c1">#&lt;--1st snapshot in the trajectory</span>
<span class="n">x2</span> <span class="n">y2</span> <span class="n">z2</span>
<span class="p">:</span>  <span class="p">:</span>  <span class="p">:</span>
<span class="n">xN</span> <span class="n">yN</span> <span class="n">zN</span>

<span class="n">x1</span> <span class="n">y1</span> <span class="n">z1</span>     <span class="c1">#&lt;--2nd snapshot in the trajectory</span>
<span class="n">x2</span> <span class="n">y2</span> <span class="n">z2</span>
<span class="p">:</span>  <span class="p">:</span>  <span class="p">:</span>
<span class="n">xN</span> <span class="n">yN</span> <span class="n">zN</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">etc</span><span class="o">...</span>
</pre></div>
</div>
<p><em>(Notes on “ndmansfield” usage: We just need to run the lattice
simulation long enough to get a random polymer conformation. This
duration should be long enough. You can check long enough by watching
the messages from ndmansfield printed to the stderr. The number of bonds
in each direction: x,y,z should be approximately equal. Incidentally, he
coordinates generated ndmansfield are nonnegative integers.)</em></p>
<p>We want to extract the last frame of this trajectory. The length of the
lattice polymer in this example is Nx*Ny*Nz = 53*40*31 = 65720 but we
add 1 because there is a blank line separating each frame.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tail</span> <span class="o">-</span><span class="n">n</span> <span class="mi">65721</span> <span class="n">ndmansfield_traj_53x40x31</span><span class="o">.</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">coords</span><span class="o">.</span><span class="n">raw</span>
</pre></div>
</div>
<p>It might be convenient to center these coordinates before continuing, so
we do that next:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">recenter_coords</span><span class="o">.</span><span class="n">py</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">coords</span><span class="o">.</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">coords_cen</span><span class="o">.</span><span class="n">raw</span>
</pre></div>
</div>
<p><em>(Note: The recenter_coords.py script is included with moltemplate.)</em></p>
<p>Suppose we want our final polymer to contain 150000 monomers, run
“interpolate_curve.py” this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interpolate_curve</span><span class="o">.</span><span class="n">py</span> <span class="mi">150000</span> <span class="mf">7.99</span> <span class="o">&lt;</span> <span class="n">coords_cen</span><span class="o">.</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">coords_smoothed</span><span class="o">.</span><span class="n">raw</span>
</pre></div>
</div>
<p>This will generate 150000 points at even intervals along this
interpolated path and rescale them so that the separation distance
between monomers is ~3.50, which equals 7.99*(65720/150000)*1. (Recall
that the original space between the points in the “coords_cen.raw” file
is 1.) Then, use <em>genpoly_lt.py</em> to generate a polymer which wraps along
the length of this curve:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">genpoly_lt</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">monomer</span><span class="o">-</span><span class="n">name</span> <span class="s2">&quot;Monomer&quot;</span> \
              <span class="o">-</span><span class="n">polymer</span><span class="o">-</span><span class="n">name</span> <span class="s2">&quot;Polymer&quot;</span> \
              <span class="o">-</span><span class="n">bond</span> <span class="n">Backbone</span> <span class="n">C</span> <span class="n">C</span> \
              <span class="o">&lt;</span> <span class="n">coords_smoothed</span><span class="o">.</span><span class="n">raw</span> <span class="o">&gt;</span> <span class="n">polymer</span><span class="o">.</span><span class="n">lt</span>
</pre></div>
</div>
<p>(Then use moltemplate.sh to convert this file into a LAMMPS data file.)</p>
</div>
</div>
<div class="section" id="python-api">
<h2><span class="section-number">21.3. </span>Python API<a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ResampleCurve</span><span class="p">(</span><span class="n">x_orig</span><span class="p">,</span>     <span class="c1"># a list or array of points lying along the curve</span>
                  <span class="n">num_points</span><span class="p">,</span> <span class="c1"># number of points you want the new curve to have</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># optional: the alpha interpolation parameter</span>
</pre></div>
</div>
</div>
<div class="section" id="usage-example-inside-python">
<h2><span class="section-number">21.4. </span>Usage example inside python<a class="headerlink" href="#usage-example-inside-python" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># Generate a zig-zag curve containing N points</span>
<span class="n">x_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)])</span>

<span class="c1"># Now generate a smooth version of this curve:</span>
<span class="kn">import</span> <span class="nn">moltemplate</span>
<span class="n">x_new</span> <span class="o">=</span> <span class="n">moltemplate</span><span class="o">.</span><span class="n">interpolate_curve</span><span class="o">.</span><span class="n">ResampleCurve</span><span class="p">(</span><span class="n">x_orig</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that there are other free python libraries for curve interpolation,
such as
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html">scipy.interpolate.interp1d</a>.
These libraries are certainly faster (and perhaps more flexible) than
this one.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">moltemplate</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/quick_reference.html">3. Quick reference <em>(skip on first reading)</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/tutorial.html">4. Introductory tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/overview.html">5. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/coordinates.html">6. Object composition and coordinate generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/arrays.html">7. Arrays, slices, and coordinate transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/custom_xform.html">8. Customizing molecule position and topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/spce_example_robust.html">9. Portability: Using <em>LT files</em> for force-field storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/limitations.html">10. Known bugs and limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/nbody_by_type.html">11. Bonded interactions “By Type”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/ltemplify.html">12. Using ltemplify.py to create an <em>LT file</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/vmd_advanced.html">13. Visualization in VMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/ttree_man_page.html">14. Advanced moltemplate.sh Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/ttree.html">15. Using <em>lttree.py</em> or <em>ttree.py</em> directly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/nbody_by_type_utility.html">16. Using the <em>nbody_by_type.py</em> utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/adv_variable_syntax.html">17. Variable syntax details</a></li>
<li class="toctree-l1"><a class="reference internal" href="dump2data.html">18. dump2data.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="extract_lammps_data.html">19. extract_lammps_data.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="genpoly_lt.html">20. genpoly_lt.py</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">21. interpolate_curve.py</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#description">21.1. Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage-from-the-terminal">21.2. Usage (from the terminal)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python-api">21.3. Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage-example-inside-python">21.4. Usage example inside python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ltemplify.html">22. ltemplify.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="raw2data.html">23. raw2data.py</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="genpoly_lt.html" title="previous chapter"><span class="section-number">20. </span>genpoly_lt.py</a></li>
      <li>Next: <a href="ltemplify.html" title="next chapter"><span class="section-number">22. </span>ltemplify.py</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Andrew Jewett.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/utils/interpolate_curve.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>