
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>14. Advanced moltemplate.sh Usage &#8212; moltemplate 2.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15. Using lttree.py or ttree.py directly" href="ttree.html" />
    <link rel="prev" title="13. Visualization in VMD" href="vmd_advanced.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="advanced-moltemplate-sh-usage">
<span id="sec-tree-man-page"></span><h1><span class="section-number">14. </span>Advanced moltemplate.sh Usage<a class="headerlink" href="#advanced-moltemplate-sh-usage" title="Permalink to this headline">¶</a></h1>
<p>moltemplate.sh has several optional command line arguments. These are
explained in below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span>

<span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="p">[</span><span class="o">-</span><span class="n">atomstyle</span> <span class="n">style</span><span class="p">]</span> \
               <span class="p">[</span><span class="o">-</span><span class="n">pdb</span><span class="o">/-</span><span class="n">xyz</span><span class="o">/-</span><span class="n">raw</span> <span class="n">coord_file</span><span class="p">]</span> \
               <span class="p">[</span><span class="o">-</span><span class="n">a</span> <span class="n">assignments</span><span class="o">.</span><span class="n">txt</span><span class="p">]</span> <span class="n">file</span><span class="o">.</span><span class="n">lt</span>

<span class="n">Optional</span> <span class="n">arguments</span><span class="p">:</span>

<span class="o">-</span><span class="n">atomstyle</span> <span class="n">style</span>  <span class="n">By</span> <span class="n">default</span><span class="p">,</span> <span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="n">assumes</span> <span class="n">you</span> <span class="n">are</span> <span class="n">using</span> <span class="n">the</span> <span class="s2">&quot;full&quot;</span>
                <span class="n">atom</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">LAMMPS</span><span class="o">.</span>  <span class="n">You</span> <span class="n">can</span> <span class="n">change</span> <span class="n">the</span> <span class="n">atom</span> <span class="n">style</span> <span class="n">to</span> <span class="s2">&quot;dipole&quot;</span>
                <span class="n">using</span> <span class="o">-</span><span class="n">atomstyle</span> <span class="n">dipole</span><span class="o">.</span>  <span class="n">If</span> <span class="n">you</span> <span class="n">are</span> <span class="n">using</span> <span class="n">a</span> <span class="n">hybrid</span> <span class="n">style</span><span class="p">,</span>
                <span class="n">you</span> <span class="n">must</span> <span class="n">enclose</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">styles</span> <span class="ow">in</span> <span class="n">quotes</span><span class="o">.</span>  <span class="n">For</span> <span class="n">example</span><span class="p">:</span>
                <span class="o">-</span><span class="n">atomstyle</span> <span class="s2">&quot;hybrid full dipole&quot;</span>
                <span class="n">For</span> <span class="n">custom</span> <span class="n">atom</span> <span class="n">styles</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">also</span> <span class="n">specify</span> <span class="n">the</span>
                <span class="nb">list</span> <span class="n">of</span> <span class="n">column</span> <span class="n">names</span> <span class="n">manually</span> <span class="p">(</span><span class="n">enclosed</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">):</span>
                <span class="o">-</span><span class="n">atomstyle</span> <span class="s2">&quot;molid x y z atomid atomtype mux muy muz&quot;</span>
                <span class="n">Be</span> <span class="n">careful</span> <span class="n">to</span> <span class="n">enclose</span> <span class="n">the</span> <span class="n">entire</span> <span class="nb">list</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">(</span><span class="s2">&quot;).</span>

<span class="o">-</span><span class="n">raw</span> <span class="n">raw_file</span>   <span class="n">The</span> <span class="n">raw_file</span> <span class="n">file</span> <span class="n">should</span> <span class="n">contain</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span> <span class="ow">in</span> <span class="n">RAW</span> <span class="nb">format</span><span class="o">.</span>
                <span class="n">RAW</span> <span class="n">files</span> <span class="n">are</span> <span class="n">simple</span> <span class="mi">3</span><span class="o">-</span><span class="n">column</span> <span class="n">ASCII</span> <span class="n">files</span> <span class="n">containin</span> <span class="n">the</span> <span class="n">coordinates</span>
                <span class="k">for</span> <span class="n">the</span> <span class="n">atoms</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">system</span><span class="o">.</span> <span class="p">(</span><span class="n">One</span> <span class="n">line</span> <span class="n">per</span> <span class="n">atom</span><span class="p">,</span> <span class="mi">3</span> <span class="n">numbers</span> <span class="n">per</span> <span class="n">line</span><span class="o">.</span>
                <span class="n">The</span> <span class="n">atoms</span> <span class="n">must</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">data</span> <span class="n">file</span><span class="o">.</span><span class="p">)</span>
<span class="o">-</span><span class="n">xyz</span> <span class="n">xyz_file</span>   <span class="n">An</span> <span class="n">xyz_file</span> <span class="n">argument</span> <span class="n">should</span> <span class="n">be</span> <span class="n">supplied</span> <span class="k">as</span> <span class="n">an</span> <span class="n">argument</span>
                <span class="n">following</span> <span class="s2">&quot;-xyz&quot;</span><span class="o">.</span>
                <span class="n">This</span> <span class="n">file</span> <span class="n">should</span> <span class="n">contain</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span> <span class="ow">in</span> <span class="n">xyz</span> <span class="nb">format</span><span class="o">.</span>
                <span class="p">(</span><span class="n">The</span> <span class="n">atoms</span> <span class="n">must</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">data</span> <span class="n">file</span><span class="o">.</span><span class="p">)</span>

<span class="o">-</span><span class="n">pdb</span> <span class="n">pdb_file</span>   <span class="n">The</span> <span class="n">pdb_file</span> <span class="n">file</span> <span class="n">should</span> <span class="n">contain</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span> <span class="ow">in</span> <span class="n">PDB</span> <span class="nb">format</span><span class="o">.</span>

                <span class="n">This</span> <span class="n">file</span> <span class="n">should</span> <span class="n">contain</span> <span class="n">one</span> <span class="n">ATOM</span> <span class="ow">or</span> <span class="n">HETATM</span> <span class="n">record</span> <span class="n">per</span> <span class="n">atom</span><span class="o">.</span>  <span class="n">Atoms</span>

                <span class="n">are</span> <span class="nb">sorted</span> <span class="n">by</span> <span class="n">chainID</span><span class="p">,</span> <span class="n">resID</span><span class="p">,</span> <span class="n">insertCode</span><span class="p">,</span> <span class="n">atomID</span> <span class="p">(</span><span class="ow">in</span> <span class="n">that</span> <span class="n">order</span><span class="p">)</span><span class="o">.</span>
                <span class="n">This</span> <span class="n">order</span> <span class="n">must</span> <span class="n">match</span> <span class="n">the</span> <span class="n">order</span> <span class="n">the</span> <span class="n">atoms</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">data</span> <span class="n">file</span><span class="o">.</span>

                <span class="n">If</span> <span class="n">the</span> <span class="n">PDB</span> <span class="n">file</span> <span class="n">contains</span> <span class="n">periodic</span> <span class="n">boundary</span> <span class="n">box</span> <span class="n">information</span>
                <span class="p">(</span><span class="n">IE</span><span class="o">.</span><span class="p">,</span> <span class="n">a</span> <span class="s2">&quot;CRYST1&quot;</span> <span class="n">record</span><span class="p">),</span> <span class="n">this</span> <span class="n">information</span> <span class="ow">is</span> <span class="n">also</span> <span class="n">copied</span>
                <span class="n">to</span> <span class="n">the</span> <span class="n">LAMMPS</span> <span class="n">data</span> <span class="n">file</span><span class="o">.</span>
                <span class="p">(</span><span class="n">Support</span> <span class="k">for</span> <span class="n">triclinic</span> <span class="n">cells</span> <span class="ow">is</span> <span class="n">experimental</span> <span class="k">as</span> <span class="n">of</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mf">03.</span>
                <span class="n">Other</span> <span class="n">molecular</span> <span class="n">structure</span> <span class="n">formats</span> <span class="n">may</span> <span class="n">be</span> <span class="n">supported</span> <span class="n">later</span><span class="o">.</span>
<span class="o">-</span><span class="n">a</span> <span class="s2">&quot;@atom:x 1&quot;</span>
<span class="o">-</span><span class="n">a</span> <span class="n">assignments</span><span class="o">.</span><span class="n">txt</span>
                <span class="n">The</span> <span class="n">user</span> <span class="n">can</span> <span class="n">customize</span> <span class="n">the</span> <span class="n">numbers</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">atom</span><span class="p">,</span> <span class="n">bond</span><span class="p">,</span>
                <span class="n">angle</span><span class="p">,</span> <span class="n">dihedral</span><span class="p">,</span> <span class="ow">and</span> <span class="n">improper</span> <span class="n">types</span> <span class="ow">or</span> <span class="nb">id</span> <span class="n">numbers</span> <span class="n">by</span> <span class="n">using</span>
                   <span class="o">-</span><span class="n">a</span> <span class="s2">&quot;VARIABLE_NAME VALUE&quot;</span>
                <span class="k">for</span> <span class="n">each</span> <span class="n">variable</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">modify</span><span class="o">.</span>  <span class="n">If</span> <span class="n">there</span> <span class="n">are</span> <span class="n">many</span>
                <span class="n">variables</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">modify</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">save</span> <span class="n">them</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">file</span>
                <span class="p">(</span><span class="n">one</span> <span class="n">variable</span> <span class="n">per</span> <span class="n">line</span><span class="p">)</span><span class="o">.</span>  <span class="n">For</span> <span class="n">an</span> <span class="n">example</span> <span class="n">of</span> <span class="n">the</span> <span class="n">file</span> <span class="nb">format</span>
                <span class="n">run</span> <span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="n">once</span> <span class="ow">and</span> <span class="n">search</span> <span class="k">for</span> <span class="n">a</span> <span class="n">file</span> <span class="n">named</span>
                <span class="s2">&quot;ttree_assignments.txt&quot;</span><span class="o">.</span>  <span class="p">(</span><span class="n">This</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">often</span> <span class="n">located</span> <span class="ow">in</span>
                <span class="n">the</span> <span class="s2">&quot;output_ttree/&quot;</span> <span class="n">directory</span><span class="o">.</span><span class="p">)</span> <span class="n">Once</span> <span class="n">assigned</span><span class="p">,</span> <span class="n">the</span> <span class="n">remaining</span>
                <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">category</span> <span class="n">will</span> <span class="n">be</span> <span class="n">automatically</span> <span class="n">assigned</span>
                <span class="n">to</span> <span class="n">values</span> <span class="n">which</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">overlap</span> <span class="k">with</span> <span class="n">your</span> <span class="n">chosen</span> <span class="n">values</span><span class="o">.</span>
<span class="o">-</span><span class="n">b</span> <span class="n">assignments</span><span class="o">.</span><span class="n">txt</span>
                <span class="s2">&quot;-b&quot;</span> <span class="ow">is</span> <span class="n">similar</span> <span class="n">to</span> <span class="s2">&quot;-a&quot;</span><span class="o">.</span> <span class="n">However</span><span class="p">,</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">case</span><span class="p">,</span> <span class="n">no</span> <span class="n">attempt</span>
                <span class="ow">is</span> <span class="n">made</span> <span class="n">to</span> <span class="n">assign</span> <span class="n">exclusive</span> <span class="p">(</span><span class="n">unique</span><span class="p">)</span> <span class="n">values</span> <span class="n">to</span> <span class="n">each</span> <span class="n">variable</span><span class="o">.</span>
<span class="o">-</span><span class="n">nocheck</span>
               <span class="n">Normally</span> <span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="n">checks</span> <span class="k">for</span> <span class="n">common</span> <span class="n">errors</span> <span class="ow">and</span> <span class="n">typos</span> <span class="ow">and</span>
               <span class="n">halts</span> <span class="k">if</span> <span class="n">it</span> <span class="n">thinks</span> <span class="n">it</span> <span class="n">has</span> <span class="n">found</span> <span class="n">one</span><span class="o">.</span>  <span class="n">This</span> <span class="n">forces</span> <span class="n">the</span> <span class="n">variables</span>
               <span class="ow">and</span> <span class="n">categories</span> <span class="k">as</span> <span class="n">well</span> <span class="k">as</span> <span class="n">write</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="ow">and</span> <span class="n">write_once</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
               <span class="n">commands</span> <span class="n">to</span> <span class="n">obey</span> <span class="n">standard</span> <span class="n">naming</span> <span class="n">conventions</span><span class="o">.</span>  <span class="n">The</span> <span class="s2">&quot;-nocheck&quot;</span>
               <span class="n">argument</span> <span class="n">bypasses</span> <span class="n">these</span> <span class="n">checks</span> <span class="ow">and</span> <span class="n">eliminates</span> <span class="n">these</span> <span class="n">restrictions</span><span class="o">.</span>
<span class="o">-</span><span class="n">checkff</span>
                <span class="n">This</span> <span class="n">cause</span> <span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="n">to</span> <span class="n">check</span> <span class="n">to</span> <span class="n">make</span> <span class="n">sure</span> <span class="n">that</span> <span class="n">there</span>
                <span class="n">are</span> <span class="n">valid</span> <span class="n">angle</span> <span class="ow">and</span> <span class="n">dihedral</span> <span class="n">interactions</span> <span class="n">defined</span> <span class="k">for</span> <span class="n">every</span>
                <span class="mi">3</span> <span class="ow">or</span> <span class="mi">4</span> <span class="n">consecutively</span> <span class="n">bonded</span> <span class="n">atoms</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">system</span>
                <span class="p">(</span><span class="n">defined</span> <span class="ow">in</span> <span class="s2">&quot;Angles/Dihedrals By Type&quot;</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
<div class="section" id="manual-variables-assignment-a-or-b">
<span id="sec-manual-assignment"></span><h2><span class="section-number">14.1. </span>Manual variables assignment (“-a” or “-b”)<a class="headerlink" href="#manual-variables-assignment-a-or-b" title="Permalink to this headline">¶</a></h2>
<p>It is possible to manually customize the values assigned to the atom
types (or to any other ttree-style variables). For example, consider the
the “spce.lt” file shown earlier. This file defines a single water
molecule with two atom types (hydrogen and oxygen). Typically the “O”
atom type is normally assigned to the integer “1”, and “H” would be
assigned to “2”. This is because “O” appears before “H” in that file. If
you wanted to swap the order, you could swap the order in which they
first appear.</p>
<p>Alternately you can specify the atom assignments directly using one or
more “-a” flags followed by a quoted assignment string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span> <span class="s1">&#39;@atom:SPCE/O 2&#39;</span> <span class="n">system</span><span class="o">.</span><span class="n">lt</span>
</pre></div>
</div>
<p>This assigns the oxygen atom type to “2”. Note that quotes are necessary
around the ’&#64;atom:SPCE/O 2’ string, which is a single argument. (Also
note that it is necessary to include SPCE/ before the O, because in that
example, this atom appeared (and was thus defined) inside the SPCE
molecule’s environment. Alternately, if it had been defined outside,
globally, then you could refer to it using “&#64;atom:O”)</p>
<p>Variables need not be assigned to numbers. If for some reason, you want
to substitute “a string” everywhere this atom type appears, you would do
it this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span> <span class="s1">&#39;@atom:SPCE/O &quot;a string&quot;&#39;</span> <span class="n">system</span><span class="o">.</span><span class="n">lt</span>
</pre></div>
</div>
<p>Multiple assignments can be made by using multiple “-a” flags:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span> <span class="s1">&#39;@atom:SPCE/O 2&#39;</span>  <span class="o">-</span><span class="n">a</span> <span class="s1">&#39;@atom:SPCE/H 1&#39;</span> <span class="n">system</span><span class="o">.</span><span class="n">lt</span>
</pre></div>
</div>
<p>However if you have a large number of assignments to make, it may be
more convenient to store them in a file. You can create a two-column
text file (for example “new_assignments.txt”) and run moltemplate this
way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">a</span> <span class="n">new_assignments</span><span class="o">.</span><span class="n">txt</span> <span class="n">system</span><span class="o">.</span><span class="n">lt</span>
</pre></div>
</div>
<p>The contents of the “new_assignments.txt” file in this example would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@atom</span><span class="p">:</span><span class="n">SPCE</span><span class="o">/</span><span class="n">O</span>  <span class="mi">2</span>
<span class="nd">@atom</span><span class="p">:</span><span class="n">SPCE</span><span class="o">/</span><span class="n">H</span>  <span class="mi">1</span>
</pre></div>
</div>
<p>The order of lines in this file does not matter.</p>
<div class="section" id="assigning-angle-dihedral-improper-variables">
<h3><span class="section-number">14.1.1. </span>Assigning $angle, $dihedral, $improper variables<a class="headerlink" href="#assigning-angle-dihedral-improper-variables" title="Permalink to this headline">¶</a></h3>
<p>In general any kind of variable can be assigned this way (not only atom
types), including $mol, $bond, &#64;bond, &#64;angle, $angle, … as well as
user-defined variable type. <em>Caveat: The only occasional exceptions are
the $angle, $dihedral, $improper variables.</em> (When “Angles By Type”
interactions are selected by the user, and mixed with regular “Angles”,
all of the $angle variables are automatically generated. The same is
true for “Dihedrals By Type” and “Impropers By Type”. See section
<a class="reference external" href="#sec:nbody_by_type_utility">[sec:nbody_by_type_utility]</a> for an
explanation of “By Type” interactions.)</p>
<p>Angles, dihedrals, and impropers interactions are automatically
generated, and in this case the user does not have the freedom to assign
these variables.</p>
</div>
<div class="section" id="the-b-flag">
<h3><span class="section-number">14.1.2. </span>The “-b” flag<a class="headerlink" href="#the-b-flag" title="Permalink to this headline">¶</a></h3>
<p>Note that when using the “-a” flag above, care will be taken to insure
that the assignment(s) are exclusive. None of the atom types (other than
&#64;atom:SPCE/O) will be assigned “2”. (For this reason, using the “-a”
flag to change the atom type assignments can, in principle, alter the
numbers assigned other atom types, or variables.) This usually the
desired behavior. However suppose, for some reason, that you wanted to
force a variable assignment, so that other variables in the same
category are not effected. In that case, you can use the “-b” flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">moltemplate</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">b</span> <span class="s1">&#39;@atom:SPCE/O 2&#39;</span> <span class="n">system</span><span class="o">.</span><span class="n">lt</span>
</pre></div>
</div>
<p>Keep in mind, that in this example, this could cause other atom-types
(for example “&#64;atom:SPCE/H”) to be assigned to overlapping numbers.</p>
</div>
<div class="section" id="the-ttree-assignments-txt-file">
<span id="sec-ttree-assignments"></span><h3><span class="section-number">14.1.3. </span>The “ttree_assignments.txt” file<a class="headerlink" href="#the-ttree-assignments-txt-file" title="Permalink to this headline">¶</a></h3>
<p>Generally, after running moltemplate.sh, a “ttree_assignments.txt” file
will be created (or updated if it is already present) to reflect any
changes you made. (This file is usually located in the “output_ttree/”
directory. It can also be located the current directory “./”.) You can
always check this to make sure that the atom types (or any other ttree
variables) were assigned correctly.</p>
<p>The “ttree_assignments.txt” file has the same format as the
“new_assignments.txt” file example above.</p>
<p><em>Note:</em> In both files, an optional slash, “/”, may follow the “&#64;” or “$”
characters, as in “&#64;/atom:SPCE/O”. (This slash is optional and indicates
the environment in which the counter is defined. The “&#64;atom” counter is
defined globally. The “$resid” counter example described in section
<a class="reference external" href="#sec:custom_categories">14.2</a> is not.)</p>
<p><em>Bug-warning: Using the “delete” command may cause some of the instance
variables (specifically the $atom, $mol, $bond, $angle, $dihedral, and
$improper variables) to be numbered incorrectly. However static
variables (beginning with &#64;) should always be accurate. -Andrew
2019-9-03.</em></p>
</div>
<div class="section" id="lttree-py-and-ttree-py-also-accept-a-and-b-flags">
<h3><span class="section-number">14.1.4. </span>lttree.py and ttree.py also accept “-a” and “-b” flags<a class="headerlink" href="#lttree-py-and-ttree-py-also-accept-a-and-b-flags" title="Permalink to this headline">¶</a></h3>
<p>If for some reason, you are using “lttree.py” or “ttree.py” instead of
“moltemplate.sh”, then the “-a” and “-b” flags explained here also work
with these scripts. They are not specific to moltemplate.sh.</p>
</div>
</div>
<div class="section" id="customizing-the-counting-method-using-category">
<span id="sec-custom-categories"></span><h2><span class="section-number">14.2. </span>Customizing the counting method using <em>category</em><a class="headerlink" href="#customizing-the-counting-method-using-category" title="Permalink to this headline">¶</a></h2>
<p>Variables in “.lt” files are assigned to integers by default, starting
with 1, and incrementing by 1. This can be overridden using the
“category” command. For example, to create a new variable category named
“distance” which starts at <span class="math notranslate nohighlight">\(0\)</span> and increments by <span class="math notranslate nohighlight">\(0.5\)</span>, you
would include this command in your LT file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>category $distance(0.0, 0.5)
</pre></div>
</div>
<p>(This command should <em>not</em> be used with traditional counter categories
like <em>$atom, $bond, $angle, $dihedral, $improper, $mol, &#64;atom, &#64;bond,
&#64;angle, &#64;dihedral,</em> and <em>&#64;improper</em>.)</p>
</div>
<div class="section" id="creating-local-independent-counters">
<span id="sec-cpath-simple"></span><h2><span class="section-number">14.3. </span>Creating local independent counters<a class="headerlink" href="#creating-local-independent-counters" title="Permalink to this headline">¶</a></h2>
<p>By default variables in a given category are always assigned to unique
integers. This can be overridden using the “category” command. For
example, you might have a variable that keeps track of the monomer in
every polymer. The first monomer in a polymer is assigned “1”, the
second monomer, “2”, etc, <em>regardless</em> of the number of polymer in your
system.</p>
<p>To do this, we can create a new variable category named “monomerid”
which is defined within the scope of each instance of the “Polymer”
molecule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Monomer {
  write(&quot;Data Atoms&quot;) {
    $atom:ca @atom:CA $monomerid:.  0.0  0.0 0.0 0.0
    $atom:cb @atom:CB $monomerid:.  0.0  1.53 0.0 0.0
  }
}

Polymer {
  category $monomerid(1,1)
  monomers = Monomer[100]
}

polymers = Polymer[10]
</pre></div>
</div>
<p>In this example, there are 10 polymers containing 100 monomers each. The
“$monomerid” counters will be replaced with integers in the range
<span class="math notranslate nohighlight">\(1\ldots 100\)</span>, (not <span class="math notranslate nohighlight">\(1\ldots 1000\)</span>, as you might expect).
Because the “$monomerid” counter is local to the protein it is defined
within, “$monomerid” variables in other proteins do not share the same
counter, and can overlap.</p>
</div>
<div class="section" id="counting-order">
<span id="sec-order"></span><h2><span class="section-number">14.4. </span>Counting order<a class="headerlink" href="#counting-order" title="Permalink to this headline">¶</a></h2>
<p>Most variables are assigned automatically. By default static variables
(&#64;) are assigned in the order they appear in the file (or files, if
multiple LT files are included). Subsequently, instance variables ($)
are assigned in the order they are created during instantiation. However
you can customize the order in which they are assigned.</p>
<div class="section" id="ordering">
<h3><span class="section-number">14.4.1. </span>Ordering<a class="headerlink" href="#ordering" title="Permalink to this headline">¶</a></h3>
<p>LT files are parsed by moltemplate.sh/lttree.py in multiple stages. The
“write_once()” and “write()” commands are carried out in the static and
instance phases respectively, as explained below.</p>
</div>
<div class="section" id="the-static-phase">
<h3><span class="section-number">14.4.2. </span>The <em>static</em> phase<a class="headerlink" href="#the-static-phase" title="Permalink to this headline">¶</a></h3>
<p>In the “static” phase, “write_once()” statements are carried out in the
order they are read from the user’s input file(s) (regardless of whether
or not they appear in nested classes). Any “include” commands will
effect this order. After processing the class definitions, and carrying
out the “write_once()” commands, lttree.py begins the instantiation
phase.</p>
</div>
<div class="section" id="the-instantiation-phase">
<h3><span class="section-number">14.4.3. </span>The <em>instantiation</em> phase<a class="headerlink" href="#the-instantiation-phase" title="Permalink to this headline">¶</a></h3>
<p>During this phase, lttree.py makes copies of (instantiates) classes
which were requested by the user using the “new” command. During this
stage, lttree.py also appends data to files using the “write” command.
(In this manual, the “write()” and “new” are called instance commands.)
The sequence of alternating “write()” and “new” commands in the order
that they appear in the user’s input file(s). “new” commands recursively
invoke any instance commands for each copy of the class they create.</p>
<p>Again, the counting of instance variables (prefixed by “$”) does not
interfere with static variable assignment. For example “&#64;atom:x” and
“$atom:x” correspond to different variables and belong to different
variable categories (“&#64;atom” and “$atom”) and they are assigned to
numerical values independently.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">moltemplate</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/quick_reference.html">3. Quick reference <em>(skip on first reading)</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/tutorial.html">4. Introductory tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/overview.html">5. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/coordinates.html">6. Object composition and coordinate generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/arrays.html">7. Arrays, slices, and coordinate transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/custom_xform.html">8. Customizing molecule position and topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="spce_example_robust.html">9. Portability: Using <em>LT files</em> for force-field storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main/limitations.html">10. Known bugs and limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbody_by_type.html">11. Bonded interactions “By Type”</a></li>
<li class="toctree-l1"><a class="reference internal" href="ltemplify.html">12. Using ltemplify.py to create an <em>LT file</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="vmd_advanced.html">13. Visualization in VMD</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">14. Advanced moltemplate.sh Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#manual-variables-assignment-a-or-b">14.1. Manual variables assignment (“-a” or “-b”)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customizing-the-counting-method-using-category">14.2. Customizing the counting method using <em>category</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-local-independent-counters">14.3. Creating local independent counters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#counting-order">14.4. Counting order</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ttree.html">15. Using <em>lttree.py</em> or <em>ttree.py</em> directly</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbody_by_type_utility.html">16. Using the <em>nbody_by_type.py</em> utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="adv_variable_syntax.html">17. Variable syntax details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/dump2data.html">18. dump2data.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/extract_lammps_data.html">19. extract_lammps_data.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/genpoly_lt.html">20. genpoly_lt.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/interpolate_curve.html">21. interpolate_curve.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/ltemplify.html">22. ltemplify.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/raw2data.html">23. raw2data.py</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="vmd_advanced.html" title="previous chapter"><span class="section-number">13. </span>Visualization in VMD</a></li>
      <li>Next: <a href="ttree.html" title="next chapter"><span class="section-number">15. </span>Using <em>lttree.py</em> or <em>ttree.py</em> directly</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Andrew Jewett.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/appendix/ttree_man_page.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>